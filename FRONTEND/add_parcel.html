<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Add Parcel</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <header><h1>Book a Parcel</h1></header>

  <form id="parcelForm">
    <h2>Parcel Details</h2>
    <input type="number" id="sender_id" placeholder="Sender ID" required />
    <input type="number" id="receiver_id" placeholder="Receiver ID" required />
    <input type="number" step="0.1" id="weight_kg" placeholder="Weight (kg)" required />
    <input type="text" id="type" placeholder="Type (Fragile, Document...)" required />
    <input type="text" id="dimensions" placeholder="Dimensions (e.g., 20x10x5 cm)" />

    <button type="submit">Add Parcel</button>
  </form>

  <p style="text-align:center; margin-top:20px;">
    <a href="index.html">⬅ Back to Home</a>
  </p>

  <footer><p>© 2025 CPDS | All Rights Reserved</p></footer>

  <script>
    document.getElementById("parcelForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        sender_id: document.getElementById("sender_id").value,
        receiver_id: document.getElementById("receiver_id").value,
        weight_kg: document.getElementById("weight_kg").value,
        type: document.getElementById("type").value,
        dimensions: document.getElementById("dimensions").value || null
      };

      try {
        const res = await fetch("http://localhost:5000/api/parcels", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const msg = await res.json();

        if (res.ok) {
          Swal.fire({
            icon: 'success',
            title: 'Parcel Added!',
            text: msg.message || 'Your parcel has been successfully booked.',
            confirmButtonColor: '#007bff'
          });
          e.target.reset();
        } else {
          Swal.fire({
            icon: 'error',
            title: 'Error!',
            text: msg.message || 'Failed to add parcel. Please try again.',
            confirmButtonColor: '#d33'
          });
        }
      } catch (error) {
        Swal.fire({
          icon: 'error',
          title: 'Network Error!',
          text: 'Unable to connect to the server.',
          confirmButtonColor: '#d33'
        });
      }
    });
  </script>
</body>
</html>
